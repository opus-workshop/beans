id: '6'
title: Create bpick fuzzy selector tool
status: closed
priority: 2
created_at: 2026-01-31T16:54:29.962383Z
updated_at: 2026-01-31T16:54:29.962383Z
description: |-
  Implement a shell wrapper script that integrates with `bn list --json` to provide interactive bean selection via fzf. This enables ergonomic workflows like `bn close $(bpick)` and `bn show $(bpick)`.

  ## Script Location
  tools/bpick - A POSIX-compatible shell script that wraps fzf for bean selection.

  ## Dependencies
  - fzf (fuzzy finder) - interactive selection interface
  - jq (JSON query tool) - parse JSON output from `bn list --json`
  - bn (beans CLI) - must be in PATH

  ## What It Does

  1. Run `bn list --json` to get all beans
  2. Use jq to transform JSON into human-readable format
  3. Pipe formatted beans to fzf for interactive selection
  4. Return selected bean ID to stdout
  5. Handle errors gracefully

  ## Usage Examples

  ```bash
  bn close $(bpick)    # Close the selected bean
  bn show $(bpick)     # Show details of selected bean
  bn claim $(bpick)    # Claim a bean
  ```

  ## Format Details

  Output format: "{id} [{status}] {title}"

  fzf configuration:
  - Height: 50% of terminal
  - Preview: show full bean details
  - Single select mode (one bean at a time)

  ## Error Handling

  Exit codes:
  - 0: Success, bean ID output
  - 1: fzf/jq/bn not installed or parse error
  - 130: User abort (Ctrl+C)
acceptance: |-
  - Script exists at tools/bpick and is executable
  - POSIX-compliant shell script (passes shellcheck)
  - Dependency checks for fzf, jq, bn with helpful error messages
  - Executes `bn list --json` successfully
  - Parses JSON output correctly
  - fzf integration works with proper formatting
  - Handles edge cases (no beans, user abort, special chars)
verify: shellcheck tools/bpick 2>/dev/null || true; test -x tools/bpick && echo 'bpick script verified'
