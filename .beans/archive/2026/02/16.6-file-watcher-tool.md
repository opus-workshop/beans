id: '16.6'
title: File Watcher Tool
slug: file-watcher-tool
status: closed
priority: 2
created_at: 2026-02-02T09:24:09.288026Z
updated_at: 2026-02-02T09:31:02.480434Z
description: |-
  Create a pi extension that watches files and notifies on changes.

  ## Problem
  No way to know when:
  - Build completes (watch for output artifact)
  - Test runner finishes (watch for results file)
  - External process modifies files

  ## Solution
  File watcher tool that:
  - Watches files/directories for changes
  - Notifies agent when changes occur
  - Can wait for specific file to appear

  ## Tools
  - `watch_start` - Start watching path(s) with optional pattern filter
  - `watch_stop` - Stop a watcher
  - `watch_list` - List active watchers
  - `watch_wait` - Block until file changes or appears (with timeout)

  ## Features
  - Glob pattern support (*.rs, src/**/test_*.py)
  - Debouncing (don't fire for every micro-change)
  - Change type filtering (create, modify, delete)
  - Timeout for watch_wait

  ## Implementation
  - Use chokidar or fs.watch
  - Store active watchers in extension state
  - Inject messages when files change via pi.sendMessage()

  ## Files
  - ~/.pi/agent/extensions/file-watcher/index.ts
  - ~/.pi/agent/extensions/file-watcher/package.json (for chokidar)

  ## Acceptance
  - Can watch a directory and get notified of changes
  - watch_wait blocks until file appears
  - Pattern filtering works (only notify on matching files)
  - Watchers cleaned up on session end
closed_at: 2026-02-02T09:31:02.480434Z
parent: '16'
verify: test -f ~/.pi/agent/extensions/file-watcher/index.ts
claimed_at: 2026-02-02T09:28:01.812829Z
is_archived: true
