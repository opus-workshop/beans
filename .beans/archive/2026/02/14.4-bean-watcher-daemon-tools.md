id: '14.4'
title: Bean watcher daemon tools
slug: bean-watcher-daemon-tools
status: closed
priority: 2
created_at: 2026-02-03T05:37:03.605810Z
updated_at: 2026-02-03T06:12:45.742066Z
description: |-
  ## What to implement

  Add tools for controlling the bean watcher daemon.

  ### Tools to implement

  1. **bw_status** - Show daemon status and recent activity
  2. **bw_start** - Start the watcher daemon
  3. **bw_stop** - Stop the running daemon
  4. **bw_once** - Run a single iteration (for testing)

  ### File

  ~/.pi/agent/extensions/beans-tools.ts (extend existing)

  ### Parameters

  ```typescript
  // bw_status
  Type.Object({})

  // bw_start
  Type.Object({
    pollInterval: Type.Optional(Type.Number({ description: "Seconds between polls (default 30)" })),
    maxConcurrent: Type.Optional(Type.Number({ description: "Max parallel agents (default 4)" })),
  })

  // bw_stop
  Type.Object({})

  // bw_once
  Type.Object({
    dryRun: Type.Optional(Type.Boolean({ description: "Show what would happen" })),
  })
  ```

  ### Response Shapes

  ```typescript
  // bw_status result
  {
    running: boolean,
    pid?: number,
    config: { pollInterval, maxConcurrent, tokenThreshold },
    recentActivity: [{ timestamp, beanId, action, result }],
  }
  ```

  ### Acceptance

  - bw_status shows daemon state and config
  - bw_start launches daemon in background
  - bw_stop sends SIGTERM to daemon
  - bw_once runs one poll iteration
closed_at: 2026-02-03T06:12:45.742066Z
close_reason: Implemented four separate watcher tools (bw_status, bw_start, bw_stop, bw_once) replacing the combined bn_watcher tool. Each tool has proper parameters, descriptions, and UI renderers as specified in the bean description.
parent: '14'
verify: grep -q 'bw_status' ~/.pi/agent/extensions/beans-tools.ts && grep -q 'bw_start' ~/.pi/agent/extensions/beans-tools.ts
claimed_at: 2026-02-03T06:11:43.513640Z
is_archived: true
produces:
- bw_status
- bw_start
- bw_stop
- bw_once
requires:
- BeansExtension
