id: '15.5'
title: Semantic code search tool
slug: semantic-code-search-tool
status: closed
priority: 2
created_at: 2026-02-02T09:18:12.689651Z
updated_at: 2026-02-02T09:21:31.883185Z
description: |-
  Create a pi extension for semantic code search using embeddings.

  ## Context
  ripgrep is great for exact matches but can't find code by intent.
  'find code that handles authentication' vs 'grep auth' - semantic search understands meaning.

  ## Task
  1. Create extension at ~/.pi/agent/extensions/semantic/index.ts
  2. Register tools:
     - code_index(directory) - index codebase, store embeddings
     - code_search(query, n) - semantic search, return top n matches
  3. Use OpenAI embeddings API (or local model)
  4. Store index in ~/.pi/agent/semantic-indexes/<project-hash>/

  ## Implementation
  - Chunk code files intelligently (by function/class)
  - Generate embeddings via API
  - Store in simple JSON or sqlite with vectors
  - Cosine similarity for search

  ## Files
  - ~/.pi/agent/extensions/semantic/index.ts
  - ~/.pi/agent/extensions/semantic/package.json

  ## Notes
  - Needs OPENAI_API_KEY or similar for embeddings
  - Consider using a local embedding model as fallback
  - Cache aggressively - re-indexing is expensive
closed_at: 2026-02-02T09:21:31.883185Z
parent: '15'
verify: test -f ~/.pi/agent/extensions/semantic/index.ts
claimed_at: 2026-02-02T09:20:48.116970Z
is_archived: true
