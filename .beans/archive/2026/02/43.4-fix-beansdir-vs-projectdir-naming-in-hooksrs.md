id: '43.4'
title: Fix beans_dir vs project_dir naming in hooks.rs
slug: fix-beansdir-vs-projectdir-naming-in-hooksrs
status: closed
priority: 2
created_at: 2026-02-18T05:35:29.223449Z
updated_at: 2026-02-18T06:23:27.176541Z
description: |-
  ## Context
  hooks.rs has inconsistent parameter naming. Sometimes `beans_dir` means the .beans/ directory, sometimes the project root. This causes confusion and potential bugs.

  ## Task
  1. In src/hooks.rs, rename parameters to be consistent:
     - `get_hook_path(project_dir, event)` — takes project root, returns .beans/hooks/<event>
     - `execute_hook(event, bean, project_dir, reason)` — takes project root
     - `is_trusted(project_dir)` — takes project root
     - `create_trust(project_dir)` — takes project root
     - `revoke_trust(project_dir)` — takes project root
  2. The parameter in all public functions should be called `project_dir` (not `beans_dir`) since they all append .beans/ internally
  3. Update callers in src/commands/create.rs, src/commands/close.rs, src/commands/trust.rs
  4. Update all tests
  5. Make sure all existing tests still pass

  ## Files
  - src/hooks.rs (rename parameters)
  - src/commands/create.rs (update calls)
  - src/commands/close.rs (update calls)
  - src/commands/trust.rs (update calls)

  ## Notes
  - This is a pure rename/refactor. No behavior change.
  - The callers in create.rs and close.rs already compute project_root = beans_dir.parent() before calling hooks. After this change they should pass project_root directly.
closed_at: 2026-02-18T06:23:27.176541Z
close_reason: Already fixed — all hooks.rs functions use project_dir consistently and callers pass project root correctly.
parent: '43'
verify: 'cd /Users/asher/beans && cargo test -- 2>&1 | grep -q ''test result: ok'''
claimed_at: 2026-02-18T06:21:49.241085Z
is_archived: true
tokens: 26965
tokens_updated: 2026-02-18T05:35:29.227114Z
