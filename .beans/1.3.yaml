id: '1.3'
title: Create bctx binary and CLI integration
status: closed
priority: 2
created_at: 2026-01-31T17:01:52.292820Z
updated_at: 2026-01-31T17:01:52.292820Z
description: |-
  Implement bctx as standalone binary with CLI entry point.

  ## What to Implement
  Create src/bin/bctx.rs:
  - fn main() with clap CLI
  - Arguments: bean_id or file_path
    - Examples: bctx 1, bctx 14, bctx .beans/14-slug.md
  - Load bean from file (use existing bean.rs parsing)
  - Extract paths from description (use 1.1)
  - Assemble context (use 1.2)
  - Output to stdout
  - Errors to stderr

  ## CLI Structure
  ```
  bctx [BEAN_ID]
    Bean ID or file path to assemble context for
  ```

  ## Integration
  - Update Cargo.toml: [[bin]] section for bctx binary
  - No changes to bn binary itself

  ## Error Handling
  - Bean not found: 'Bean {id} not found'
  - Invalid file path: 'File not found: {path}'
  - No paths in description: exit 0 with empty output
  - I/O errors: print to stderr with context
acceptance: |-
  - bctx binary compiles and is executable
  - bctx [id] loads bean and assembles context
  - Output is valid markdown suitable for piping to llm
  - Can pipe output: bctx 1 | wc -l
  - Errors print to stderr, not stdout
  - Returns exit code 0 on success, 1 on error
  - Help message available (bctx --help)
  - Works with bean ID and full paths
parent: '1'
dependencies:
- '1.2'
verify: cargo build --release --bin bctx && ./target/release/bctx --help
